{% extends 'base.html'%}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

    <div class="container h-100 mt-3">
		<div class="justify-content-center h-100">
			<div class="product_card">
				<div class="justify-content-center">
					{% if product %}
                        <h3 class="text-center">Update Product</h3>
                    {% else %}
                        <h3 class="text-center">Add Product</h3>
                    {% endif %}
				</div>
				<div class="justify-content-center form_container">
					<form class="form-group mx-auto" method="POST" action="" enctype="multipart/form-data">
                        {% csrf_token %}
                            <div class="row">
                                <div class="col-md-3 mb-3">
                                    {{ form.product_name|as_crispy_field }}
                                </div>
                                <div class="col-md-3 mb-3">
                                    {{ form.color|as_crispy_field }}
                                </div>
                                <div class="col-md-3 mb-3">
                                    {{ form.price|as_crispy_field }}
                                </div>
                                <div class="col-md-3 mb-3">
                                    {{ form.number_in_stock|as_crispy_field }}
                                </div>
                                
                            </div>
                            <div class="row">
                                
                                
                                <div class="col-md-4 mb-3">
                                    {{ form.image|as_crispy_field }}
                                </div>
                                <div class="col-md-2 mb-3">
                                    <h8>Current image</h8>
                                    
                                    <img class="img-fluid" style="height:100px;"src="{{ form.instance.image.url }}" />
                                </div>
                                {% if product.image_2 %}
                                    <div class="col-md-4 mb-3">
                                        {{ form.image_2|as_crispy_field }}
                                    </div>
                                    <div class="col-md-2 mb-3">
                                        <h8>Current image</h8>
                                        <img class="img-fluid" style="height:100px;"src="{{ form.instance.image_2.url }}" />
                                    </div>
                                {% else %}
                                <div class="col-md-4 mb-3">
                                    {{ form.image_2|as_crispy_field }}
                                </div>
                                
                                {% endif %}
                            </div>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    {{ form.has_size|as_crispy_field }}
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="form_errors">{{ form_errors }}</div>
                                </div>
                            </div>
						</div>
                        <div class="d-flex justify-content-center mt-3 product_container">
                            {% if product %}
                                <button class="btn btn-info" type="submit">Update</button>
                                <a class="btn btn-danger ml-2"   data-toggle="modal" data-target="#deleteProduct">Delete</a>
                            {% else %}
                                <button class="btn btn-success" type="submit">Add</button>
                            {% endif %}
                        </div>
					</form>

				</div>
		</div>
	</div>
    {% if product %}
    <!-- Modal -->
    <div class="modal fade" id="deleteProduct" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="deleteProductLabel">Delete Product</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" >
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form id="deleteForm" method="POST" action="{% url 'delete_product' product.id %}">
                {% csrf_token %}
                <h6>Are you sure you want to remove this product</h6>
            </form>
        </div>
        <div class="modal-footer">
            <button class="delete-form btn btn-danger ml-auto"type="submit">Confirm</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
        </div>
    </div>
    {% endif %}
    <script type="text/javascript">
    let form = $("#deleteForm")
    $(".delete-form").click(function(){
        form.submit()
    })
    
    </script>
{% endblock %}